<%- include('public/header.ejs', {pageName: null}); %>
<body>
  <h1>hello</h1>
  <div>
    <table border="1" style='text-align: center'>
      <thead>
        <tr>
          <th>id</th>
          <th>email</th>
          <th>name</th>
          <th>gender</th>
        </tr>
      </thead>
      <tbody>
        <% for(let i =0;i<user.rows.length;i++) {%>
          <tr>
            <td><%= user.rows[i].id%></td>
            <td><%= user.rows[i].email%></td>
            <td><%= user.rows[i].name%></td>
            <td><%= user.rows[i].gender%></td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </div>
  <input type=text id=input1 placeholder=搜索email或者姓名 />
  <button id=btn>ajax</button>
  <div id=result></div>
  <script>
    let input1 = document.querySelector('#input1')
    let btn = document.querySelector('#btn')
    let result = document.querySelector('#result')
    btn.onclick = () => {
      let data = {
        q: input1.value,
        p: 1,
        s: 10
      }
      fetch('/', {
          method: 'POST', // or 'PUT'
          body: JSON.stringify(data), // data can be string or {object}!
          headers: new Headers({
            'Content-Type': 'application/json'
          })
        }).then(res => res.json())
        .catch(error => console.error('Error:', error))
        .then(response => {
          console.log(JSON.stringify(response));
          result.innerHTML = JSON.stringify(response)
        });
    }
  </script>
</body>

</html>